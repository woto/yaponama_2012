!function(){function t(t,i,e,n){function s(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.Utils={whitespace:"\n\r	 ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(t,i){for(var e=0;e<i.length;e++)if(t===i[e])return!0;return!1}},this.get_content=function(){for(var t="",i=[],e=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return i.length?i.join(""):["","TK_EOF"];if(t=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(t,this.Utils.whitespace))i.length&&(e=!0),this.line_char_count--;else{if(e){if(this.line_char_count>=this.max_char){i.push("\n");for(var n=0;n<this.indent_level;n++)i.push(this.indent_string);this.line_char_count=0}else i.push(" "),this.line_char_count++;e=!1}i.push(t)}}return i.length?i.join(""):""},this.get_contents_to=function(t){if(this.pos===this.input.length)return["","TK_EOF"];var i="",e=new RegExp("</"+t+"\\s*>","igm");e.lastIndex=this.pos;var n=e.exec(this.input),s=n?n.index:this.input.length;return this.pos<s&&(i=this.input.substring(this.pos,s),this.pos=s),i},this.record_tag=function(t){this.tags[t+"count"]?(this.tags[t+"count"]++,this.tags[t+this.tags[t+"count"]]=this.indent_level):(this.tags[t+"count"]=1,this.tags[t+this.tags[t+"count"]]=this.indent_level),this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent,this.tags.parent=t+this.tags[t+"count"]},this.retrieve_tag=function(t){if(this.tags[t+"count"]){for(var i=this.tags.parent;i&&t+this.tags[t+"count"]!==i;)i=this.tags[i+"parent"];i&&(this.indent_level=this.tags[t+this.tags[t+"count"]],this.tags.parent=this.tags[i+"parent"]),delete this.tags[t+this.tags[t+"count"]+"parent"],delete this.tags[t+this.tags[t+"count"]],1===this.tags[t+"count"]?delete this.tags[t+"count"]:this.tags[t+"count"]--}},this.get_tag=function(t){var i,e,n="",s=[],h="",r=!1,a=this.pos,_=this.line_char_count;t=void 0!==t?t:!1;do{if(this.pos>=this.input.length)return t&&(this.pos=a,this.line_char_count=_),s.length?s.join(""):["","TK_EOF"];n=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(n,this.Utils.whitespace)?(r=!0,this.line_char_count--):(("'"===n||'"'===n)&&(s[1]&&"!"===s[1]||(n+=this.get_unformatted(n),r=!0)),"="===n&&(r=!1),s.length&&"="!==s[s.length-1]&&">"!==n&&r&&(this.line_char_count>=this.max_char?(this.print_newline(!1,s),this.line_char_count=0):(s.push(" "),this.line_char_count++),r=!1),"<"===n&&(i=this.pos-1),s.push(n))}while(">"!==n);var o,c=s.join("");o=c.indexOf(-1!==c.indexOf(" ")?" ":">");var p=c.substring(1,o).toLowerCase();return"/"===c.charAt(c.length-2)||this.Utils.in_array(p,this.Utils.single_token)?t||(this.tag_type="SINGLE"):"script"===p?t||(this.record_tag(p),this.tag_type="SCRIPT"):"style"===p?t||(this.record_tag(p),this.tag_type="STYLE"):this.is_unformatted(p,u)?(h=this.get_unformatted("</"+p+">",c),s.push(h),i>0&&this.Utils.in_array(this.input.charAt(i-1),this.Utils.whitespace)&&s.splice(0,0,this.input.charAt(i-1)),e=this.pos-1,this.Utils.in_array(this.input.charAt(e+1),this.Utils.whitespace)&&s.push(this.input.charAt(e+1)),this.tag_type="SINGLE"):"!"===p.charAt(0)?-1!==p.indexOf("[if")?(-1!==c.indexOf("!IE")&&(h=this.get_unformatted("-->",c),s.push(h)),t||(this.tag_type="START")):-1!==p.indexOf("[endif")?(this.tag_type="END",this.unindent()):-1!==p.indexOf("[cdata[")?(h=this.get_unformatted("]]>",c),s.push(h),t||(this.tag_type="SINGLE")):(h=this.get_unformatted("-->",c),s.push(h),this.tag_type="SINGLE"):t||("/"===p.charAt(0)?(this.retrieve_tag(p.substring(1)),this.tag_type="END"):(this.record_tag(p),this.tag_type="START"),this.Utils.in_array(p,this.Utils.extra_liners)&&this.print_newline(!0,this.output)),t&&(this.pos=a,this.line_char_count=_),s.join("")},this.get_unformatted=function(t,i){if(i&&-1!==i.toLowerCase().indexOf(t))return"";var e="",n="",s=!0;do{if(this.pos>=this.input.length)return n;if(e=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(e,this.Utils.whitespace)){if(!s){this.line_char_count--;continue}if("\n"===e||"\r"===e){n+="\n",this.line_char_count=0;continue}}n+=e,this.line_char_count++,s=!0}while(-1===n.toLowerCase().indexOf(t));return n},this.get_token=function(){var t;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var i=this.last_token.substr(7);return t=this.get_contents_to(i),"string"!=typeof t?t:[t,"TK_"+i]}if("CONTENT"===this.current_mode)return t=this.get_content(),"string"!=typeof t?t:[t,"TK_CONTENT"];if("TAG"===this.current_mode){if(t=this.get_tag(),"string"!=typeof t)return t;var e="TK_TAG_"+this.tag_type;return[t,e]}},this.get_full_indent=function(t){return t=this.indent_level+t||0,1>t?"":Array(t+1).join(this.indent_string)},this.is_unformatted=function(t,i){if(!this.Utils.in_array(t,i))return!1;if("a"!==t.toLowerCase()||!this.Utils.in_array("a",i))return!0;var e=this.get_tag(!0),n=(e||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!n||this.Utils.in_array(n,i)?!0:!1},this.printer=function(t,i,e,n,s){this.input=t||"",this.output=[],this.indent_character=i,this.indent_string="",this.indent_size=e,this.brace_style=s,this.indent_level=0,this.max_char=n,this.line_char_count=0;for(var h=0;h<this.indent_size;h++)this.indent_string+=this.indent_character;this.print_newline=function(t,i){if(this.line_char_count=0,i&&i.length){if(!t)for(;this.Utils.in_array(i[i.length-1],this.Utils.whitespace);)i.pop();i.push("\n");for(var e=0;e<this.indent_level;e++)i.push(this.indent_string)}},this.print_token=function(t){this.output.push(t)},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var h,r,a,_,o,u;for(i=i||{},r=i.indent_size||4,a=i.indent_char||" ",o=i.brace_style||"collapse",_=0===i.max_char?1/0:i.max_char||250,u=i.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],h=new s,h.printer(t,a,r,_,o);;){var c=h.get_token();if(h.token_text=c[0],h.token_type=c[1],"TK_EOF"===h.token_type)break;switch(h.token_type){case"TK_TAG_START":h.print_newline(!1,h.output),h.print_token(h.token_text),h.indent(),h.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":h.print_newline(!1,h.output),h.print_token(h.token_text),h.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===h.last_token&&""===h.last_text){var p=h.token_text.match(/\w+/)[0],l=h.output[h.output.length-1].match(/<\s*(\w+)/);(null===l||l[1]!==p)&&h.print_newline(!0,h.output)}h.print_token(h.token_text),h.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var f=h.token_text.match(/^\s*<([a-z]+)/i);f&&h.Utils.in_array(f[1],u)||h.print_newline(!1,h.output),h.print_token(h.token_text),h.current_mode="CONTENT";break;case"TK_CONTENT":""!==h.token_text&&h.print_token(h.token_text),h.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==h.token_text){h.output.push("\n");var g,d=h.token_text,T=1;"TK_SCRIPT"===h.token_type?g="function"==typeof e&&e:"TK_STYLE"===h.token_type&&(g="function"==typeof n&&n),"keep"===i.indent_scripts?T=0:"separate"===i.indent_scripts&&(T=-h.indent_level);var y=h.get_full_indent(T);if(g)d=g(d.replace(/^\s*/,y),i);else{var k=d.match(/^\s*/)[0],b=k.match(/[^\n\r]*$/)[0].split(h.indent_string).length-1,m=h.get_full_indent(T-b);d=d.replace(/^\s*/,y).replace(/\r\n|\r|\n/g,"\n"+m).replace(/\s*$/,"")}d&&(h.print_token(d),h.print_newline(!0,h.output))}h.current_mode="TAG"}h.last_token=h.token_type,h.last_text=h.token_text}return h.output.join("")}if("function"==typeof define)define(function(i,e){var n=i("./beautify.js").js_beautify,s=i("./beautify-css.js").css_beautify;e.html_beautify=function(i,e){return t(i,e,n,s)}});else if("undefined"!=typeof exports){var i=require("./beautify.js").js_beautify,e=require("./beautify-css.js").css_beautify;exports.html_beautify=function(n,s){return t(n,s,i,e)}}else"undefined"!=typeof window?window.html_beautify=function(i,e){return t(i,e,window.js_beautify,window.css_beautify)}:"undefined"!=typeof global&&(global.html_beautify=function(i,e){return t(i,e,global.js_beautify,global.css_beautify)})}();