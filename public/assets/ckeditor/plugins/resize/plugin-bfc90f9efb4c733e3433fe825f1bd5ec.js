CKEDITOR.plugins.add("resize",{init:function(e){var i,t,n,r,o=e.config,s=e.ui.spaceId("resizer"),m=e.element?e.element.getDirection(1):"ltr";if(!o.resize_dir&&(o.resize_dir="vertical"),void 0==o.resize_maxWidth&&(o.resize_maxWidth=3e3),void 0==o.resize_maxHeight&&(o.resize_maxHeight=3e3),void 0==o.resize_minWidth&&(o.resize_minWidth=750),void 0==o.resize_minHeight&&(o.resize_minHeight=250),!1!==o.resize_enabled){var a=null,d=("both"==o.resize_dir||"horizontal"==o.resize_dir)&&o.resize_minWidth!=o.resize_maxWidth,u=("both"==o.resize_dir||"vertical"==o.resize_dir)&&o.resize_minHeight!=o.resize_maxHeight,c=function(s){var a=i,c=t,z=a+(s.data.$.screenX-n)*("rtl"==m?-1:1),s=c+(s.data.$.screenY-r);d&&(a=Math.max(o.resize_minWidth,Math.min(z,o.resize_maxWidth))),u&&(c=Math.max(o.resize_minHeight,Math.min(s,o.resize_maxHeight))),e.resize(d?a:null,c)},z=function(){CKEDITOR.document.removeListener("mousemove",c),CKEDITOR.document.removeListener("mouseup",z),e.document&&(e.document.removeListener("mousemove",c),e.document.removeListener("mouseup",z))},h=CKEDITOR.tools.addFunction(function(s){a||(a=e.getResizable()),i=a.$.offsetWidth||0,t=a.$.offsetHeight||0,n=s.screenX,r=s.screenY,o.resize_minWidth>i&&(o.resize_minWidth=i),o.resize_minHeight>t&&(o.resize_minHeight=t),CKEDITOR.document.on("mousemove",c),CKEDITOR.document.on("mouseup",z),e.document&&(e.document.on("mousemove",c),e.document.on("mouseup",z)),s.preventDefault&&s.preventDefault()});e.on("destroy",function(){CKEDITOR.tools.removeFunction(h)}),e.on("uiSpace",function(i){if("bottom"==i.data.space){var t="";d&&!u&&(t=" cke_resizer_horizontal"),!d&&u&&(t=" cke_resizer_vertical");var n='<span id="'+s+'" class="cke_resizer'+t+" cke_resizer_"+m+'" title="'+CKEDITOR.tools.htmlEncode(e.lang.common.resize)+'" onmousedown="CKEDITOR.tools.callFunction('+h+', event)">'+("ltr"==m?"◢":"◣")+"</span>";"ltr"==m&&"ltr"==t?i.data.html+=n:i.data.html=n+i.data.html}},e,null,100),e.on("maximize",function(i){e.ui.space("resizer")[i.data==CKEDITOR.TRISTATE_ON?"hide":"show"]()})}}});