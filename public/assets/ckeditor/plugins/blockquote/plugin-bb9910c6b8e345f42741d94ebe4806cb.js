!function(){var e={exec:function(e){var t=e.getCommand("blockquote").state,o=e.getSelection(),r=o&&o.getRanges(!0)[0];if(r){var n=o.createBookmarks();if(CKEDITOR.env.ie){var a,l=n[0].startNode,s=n[0].endNode;if(l&&"blockquote"==l.getParent().getName())for(a=l;a=a.getNext();)if(a.type==CKEDITOR.NODE_ELEMENT&&a.isBlockBoundary()){l.move(a,!0);break}if(s&&"blockquote"==s.getParent().getName())for(a=s;a=a.getPrevious();)if(a.type==CKEDITOR.NODE_ELEMENT&&a.isBlockBoundary()){s.move(a);break}}var u=r.createIterator();if(u.enlargeBr=e.config.enterMode!=CKEDITOR.ENTER_BR,t==CKEDITOR.TRISTATE_OFF){for(l=[];t=u.getNextParagraph();)l.push(t);for(1>l.length&&(t=e.document.createElement(e.config.enterMode==CKEDITOR.ENTER_P?"p":"div"),s=n.shift(),r.insertNode(t),t.append(new CKEDITOR.dom.text("",e.document)),r.moveToBookmark(s),r.selectNodeContents(t),r.collapse(!0),s=r.createBookmark(),l.push(t),n.unshift(s)),a=l[0].getParent(),r=[],s=0;s<l.length;s++)t=l[s],a=a.getCommonAncestor(t.getParent());for(t={table:1,tbody:1,tr:1,ol:1,ul:1};t[a.getName()];)a=a.getParent();for(s=null;0<l.length;){for(t=l.shift();!t.getParent().equals(a);)t=t.getParent();t.equals(s)||r.push(t),s=t}for(;0<r.length;)if(t=r.shift(),"blockquote"==t.getName()){for(s=new CKEDITOR.dom.documentFragment(e.document);t.getFirst();)s.append(t.getFirst().remove()),l.push(s.getLast());s.replace(t)}else l.push(t);for(r=e.document.createElement("blockquote"),r.insertBefore(l[0]);0<l.length;)t=l.shift(),r.append(t)}else if(t==CKEDITOR.TRISTATE_ON){for(s=[],a={};t=u.getNextParagraph();){for(l=r=null;t.getParent();){if("blockquote"==t.getParent().getName()){r=t.getParent(),l=t;break}t=t.getParent()}r&&l&&!l.getCustomData("blockquote_moveout")&&(s.push(l),CKEDITOR.dom.element.setMarker(a,l,"blockquote_moveout",!0))}for(CKEDITOR.dom.element.clearAllMarkers(a),t=[],l=[],a={};0<s.length;)u=s.shift(),r=u.getParent(),u.getPrevious()?u.getNext()?(u.breakParent(u.getParent()),l.push(u.getNext())):u.remove().insertAfter(r):u.remove().insertBefore(r),r.getCustomData("blockquote_processed")||(l.push(r),CKEDITOR.dom.element.setMarker(a,r,"blockquote_processed",!0)),t.push(u);for(CKEDITOR.dom.element.clearAllMarkers(a),s=l.length-1;s>=0;s--){r=l[s];e:{a=r;for(var u=0,c=a.getChildCount(),i=void 0;c>u&&(i=a.getChild(u));u++)if(i.type==CKEDITOR.NODE_ELEMENT&&i.isBlockBoundary()){a=!1;break e}a=!0}a&&r.remove()}if(e.config.enterMode==CKEDITOR.ENTER_BR)for(r=!0;t.length;)if(u=t.shift(),"div"==u.getName()){for(s=new CKEDITOR.dom.documentFragment(e.document),r&&u.getPrevious()&&!(u.getPrevious().type==CKEDITOR.NODE_ELEMENT&&u.getPrevious().isBlockBoundary())&&s.append(e.document.createElement("br")),r=u.getNext()&&!(u.getNext().type==CKEDITOR.NODE_ELEMENT&&u.getNext().isBlockBoundary());u.getFirst();)u.getFirst().remove().appendTo(s);r&&s.append(e.document.createElement("br")),s.replace(u),r=!1}}o.selectBookmarks(n),e.focus()}},refresh:function(e,t){this.setState(e.elementPath(t.block||t.blockLimit).contains("blockquote",1)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)},context:"blockquote",allowedContent:"blockquote",requiredContent:"blockquote"};CKEDITOR.plugins.add("blockquote",{lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,ug,uk,vi,zh,zh-cn",icons:"blockquote",hidpi:!0,init:function(t){t.blockless||(t.addCommand("blockquote",e),t.ui.addButton&&t.ui.addButton("Blockquote",{label:t.lang.blockquote.toolbar,command:"blockquote",toolbar:"blocks,10"}))}})}();