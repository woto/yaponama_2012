CKEDITOR.plugins.add("removeformat",{lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,ug,uk,vi,zh,zh-cn",icons:"removeformat",hidpi:!0,init:function(e){e.addCommand("removeFormat",CKEDITOR.plugins.removeformat.commands.removeformat),e.ui.addButton&&e.ui.addButton("RemoveFormat",{label:e.lang.removeformat.toolbar,command:"removeFormat",toolbar:"cleanup,10"})}}),CKEDITOR.plugins.removeformat={commands:{removeformat:{exec:function(e){for(var t,o=e._.removeFormatRegex||(e._.removeFormatRegex=RegExp("^(?:"+e.config.removeFormatTags.replace(/,/g,"|")+")$","i")),r=e._.removeAttributes||(e._.removeAttributes=e.config.removeFormatAttributes.split(",")),a=CKEDITOR.plugins.removeformat.filter,m=e.getSelection().getRanges(1),n=m.createIterator();t=n.getNextRange();){t.collapsed||t.enlarge(CKEDITOR.ENLARGE_ELEMENT);var i=t.createBookmark(),s=i.startNode,l=i.endNode,g=function(t){for(var r,m=e.elementPath(t),n=m.elements,i=1;(r=n[i])&&!r.equals(m.block)&&!r.equals(m.blockLimit);i++)o.test(r.getName())&&a(e,r)&&t.breakParent(r)};if(g(s),l)for(g(l),s=s.getNextSourceNode(!0,CKEDITOR.NODE_ELEMENT);s&&!s.equals(l);)g=s.getNextSourceNode(!1,CKEDITOR.NODE_ELEMENT),!("img"==s.getName()&&s.data("cke-realelement"))&&a(e,s)&&(o.test(s.getName())?s.remove(1):(s.removeAttributes(r),e.fire("removeFormatCleanup",s))),s=g;t.moveToBookmark(i)}e.forceNextSelectionCheck(),e.getSelection().selectRanges(m)}}},filter:function(e,t){for(var o=e._.removeFormatFilters||[],r=0;r<o.length;r++)if(!1===o[r](t))return!1;return!0}},CKEDITOR.editor.prototype.addRemoveFormatFilter=function(e){this._.removeFormatFilters||(this._.removeFormatFilters=[]),this._.removeFormatFilters.push(e)},CKEDITOR.config.removeFormatTags="b,big,code,del,dfn,em,font,i,ins,kbd,q,s,samp,small,span,strike,strong,sub,sup,tt,u,var",CKEDITOR.config.removeFormatAttributes="class,style,lang,width,height,align,hspace,valign";