!function(){function e(e,t,i,r){if(!e.isReadOnly()&&!e.equals(i.editable())){CKEDITOR.dom.element.setMarker(r,e,"bidi_processed",1);for(var r=e,n=i.editable();(r=r.getParent())&&!r.equals(n);)if(r.getCustomData("bidi_processed"))return e.removeStyle("direction"),void e.removeAttribute("dir");r="useComputedState"in i.config?i.config.useComputedState:1,(r?e.getComputedStyle("direction"):e.getStyle("direction")||e.hasAttribute("dir"))!=t&&(e.removeStyle("direction"),r?(e.removeAttribute("dir"),t!=e.getComputedStyle("direction")&&e.setAttribute("dir",t)):e.setAttribute("dir",t),i.forceNextSelectionCheck())}}function t(e,t,i){var r=e.getCommonAncestor(!1,!0),e=e.clone();if(e.enlarge(i==CKEDITOR.ENTER_BR?CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS:CKEDITOR.ENLARGE_BLOCK_CONTENTS),e.checkBoundaryOfElement(r,CKEDITOR.START)&&e.checkBoundaryOfElement(r,CKEDITOR.END)){for(var n;r&&r.type==CKEDITOR.NODE_ELEMENT&&(n=r.getParent())&&1==n.getChildCount()&&!(r.getName()in t);)r=n;return r.type==CKEDITOR.NODE_ELEMENT&&r.getName()in t&&r}}function i(i){return{context:"p",allowedContent:{"h1 h2 h3 h4 h5 h6 table ul ol blockquote div tr p div li td":{propertiesOnly:!0,attributes:"dir"}},requiredContent:"p[dir]",refresh:function(e,t){var i,r=e.config.useComputedState,r=void 0===r||r;if(!r){i=t.lastElement;for(var n=e.editable();i&&!(i.getName()in a||i.equals(n));){var o=i.getParent();if(!o)break;i=o}}i=i||t.block||t.blockLimit,i.equals(e.editable())&&(n=e.getSelection().getRanges()[0].getEnclosedNode())&&n.type==CKEDITOR.NODE_ELEMENT&&(i=n),i&&(r=r?i.getComputedStyle("direction"):i.getStyle("direction")||i.getAttribute("dir"),e.getCommand("bidirtl").setState("rtl"==r?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF),e.getCommand("bidiltr").setState("ltr"==r?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)),r=(t.block||t.blockLimit||e.editable()).getDirection(1),r!=(e._.selDir||e.lang.dir)&&(e._.selDir=r,e.fire("contentDirChanged",r))},exec:function(r){var a=r.getSelection(),d=r.config.enterMode,l=a.getRanges();if(l&&l.length){for(var c,E={},s=a.createBookmarks(),l=l.createIterator(),u=0;c=l.getNextRange(1);){var g=c.getEnclosedNode();g&&(!g||g.type==CKEDITOR.NODE_ELEMENT&&g.getName()in o)||(g=t(c,n,d)),g&&e(g,i,r,E);var T=new CKEDITOR.dom.walker(c),C=s[u].startNode,O=s[u++].endNode;T.evaluator=function(e){return!!(e.type==CKEDITOR.NODE_ELEMENT&&e.getName()in n&&(e.getName()!=(d==CKEDITOR.ENTER_P?"p":"div")||e.getParent().type!=CKEDITOR.NODE_ELEMENT||"blockquote"!=e.getParent().getName())&&e.getPosition(C)&CKEDITOR.POSITION_FOLLOWING&&(e.getPosition(O)&CKEDITOR.POSITION_PRECEDING+CKEDITOR.POSITION_CONTAINS)==CKEDITOR.POSITION_PRECEDING)};for(;g=T.next();)e(g,i,r,E);for(c=c.createIterator(),c.enlargeBr=d!=CKEDITOR.ENTER_BR;g=c.getNextParagraph(d==CKEDITOR.ENTER_P?"p":"div");)e(g,i,r,E)}CKEDITOR.dom.element.clearAllMarkers(E),r.forceNextSelectionCheck(),a.selectBookmarks(s),r.focus()}}}}function r(e){var t=e==d.setAttribute,i=e==d.removeAttribute,r=/\bdirection\s*:\s*(.*?)\s*(:?$|;)/;return function(n,o){if(!this.isReadOnly()){var a;if(a=n==(t||i?"dir":"direction")||"style"==n&&(i||r.test(o))){e:{a=this;for(var d=a.getDocument().getBody().getParent();a;){if(a.equals(d)){a=!1;break e}a=a.getParent()}a=!0}a=!a}if(a&&(a=this.getDirection(1),d=e.apply(this,arguments),a!=this.getDirection(1)))return this.getDocument().fire("dirChanged",this),d}return e.apply(this,arguments)}}var n={table:1,ul:1,ol:1,blockquote:1,div:1},o={},a={};CKEDITOR.tools.extend(o,n,{tr:1,p:1,div:1,li:1}),CKEDITOR.tools.extend(a,o,{td:1}),CKEDITOR.plugins.add("bidi",{lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,ug,uk,vi,zh,zh-cn",icons:"bidiltr,bidirtl",hidpi:!0,init:function(e){function t(t,i,r,n,o){e.addCommand(r,new CKEDITOR.command(e,n)),e.ui.addButton&&e.ui.addButton(t,{label:i,command:r,toolbar:"bidi,"+o})}if(!e.blockless){var r=e.lang.bidi;t("BidiLtr",r.ltr,"bidiltr",i("ltr"),10),t("BidiRtl",r.rtl,"bidirtl",i("rtl"),20),e.on("contentDom",function(){e.document.on("dirChanged",function(t){e.fire("dirChanged",{node:t.data,dir:t.data.getDirection(1)})})}),e.on("contentDirChanged",function(t){var t=(e.lang.dir!=t.data?"add":"remove")+"Class",i=e.ui.space(e.config.toolbarLocation);i&&i[t]("cke_mixed_dir_content")})}}});for(var d=CKEDITOR.dom.element.prototype,l=["setStyle","removeStyle","setAttribute","removeAttribute"],c=0;c<l.length;c++)d[l[c]]=CKEDITOR.tools.override(d[l[c]],r)}();