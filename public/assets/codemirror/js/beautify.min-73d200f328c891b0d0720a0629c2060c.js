!function(){function t(t,n){var i=new e(t,n);return i.beautify()}function e(t,e){function n(t,e){return{mode:e,last_text:t?t.last_text:"",last_word:t?t.last_word:"",var_line:!1,var_line_tainted:!1,var_line_reindented:!1,in_html_comment:!1,multiline_array:!1,if_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:t?t.indentation_level+(t.var_line&&t.var_line_reindented?1:0):0,ternary_depth:0}}function i(t){for(t=void 0===t?!1:t;z.length&&(" "===z[z.length-1]||z[z.length-1]===Y||z[z.length-1]===pe||t&&("\n"===z[z.length-1]||"\r"===z[z.length-1]));)z.pop()}function r(t){return t.replace(/^\s\s*|\s\s*$/,"")}function a(t){t=t.replace(/\x0d/g,"");for(var e=[],n=t.indexOf("\n");-1!==n;)e.push(t.substring(0,n)),t=t.substring(n+1),n=t.indexOf("\n");return t.length&&e.push(t),e}function s(){return z.length&&"\n"===z[z.length-1]}function _(){return s()&&z.length-1>0&&"\n"===z[z.length-2]}function o(t,e){var n=t.length-1;for(0>n&&(n+=t.length),n>t.length-1&&(n=t.length-1),n++;n-->0;)if(n in t&&t[n]===e)return n;return-1}function l(t){if(t=void 0===t?!1:t,de.wrap_line_length&&!t){var e="",n=0,i=o(z,"\n")+1;i<z.length&&(e=z.slice(i).join(""),n=e.length+X.length+(oe?1:0),n>=de.wrap_line_length&&(t=!0))}(de.preserve_newlines&&se||t)&&!s()&&(h(!1,!0),_e=!0,se=!1)}function h(t,e){if(_e=!1,oe=!1,!e&&";"!==Z.last_text)for(;Z.mode===fe.Statement&&!Z.if_block;)v();Z.mode===fe.ArrayLiteral&&(Z.multiline_array=!0),z.length&&(t||!s())&&z.push("\n")}function c(){s()&&(de.keep_array_indentation&&g(Z.mode)&&ce.length?z.push(ce.join("")+""):(pe&&z.push(pe),u(Z.indentation_level),u(Z.var_line&&Z.var_line_reindented),u(_e)))}function u(t){if(void 0===t?t=1:"number"!=typeof t&&(t=t?1:0),""!==Z.last_text)for(var e=0;t>e;e+=1)z.push(Y)}function f(){if(oe&&z.length){var t=z[z.length-1];s()||" "===t||t===Y||z.push(" ")}}function d(t){t=t||X,c(),_e=!1,f(),oe=!1,z.push(t)}function p(){Z.indentation_level+=1}function T(t){Z?(H.push(Z),q=Z):q=n(null,t),Z=n(q,t)}function g(t){return t===fe.ArrayLiteral}function K(t){return x(t,[fe.Expression,fe.ForInitializer,fe.Conditional])}function v(){H.length>0&&(q=Z,Z=H.pop())}function E(){return"do"===Z.last_text||"else"===Z.last_text&&"if"!==X||"TK_END_EXPR"===Q&&(q.mode===fe.ForInitializer||q.mode===fe.Conditional)?(l(),T(fe.Statement),p(),_e=!1,!0):!1}function m(t,e){for(var n=0;n<t.length;n++){var i=r(t[n]);if(i.charAt(0)!==e)return!1}return!0}function A(t){return x(t,["case","return","do","if","throw","else"])}function x(t,e){for(var n=0;n<e.length;n+=1)if(e[n]===t)return!0;return!1}function O(t){for(var e,n=!1,i="",r=0,a="",s=0;n||r<t.length;)if(e=t.charAt(r),r++,n){if(n=!1,"x"===e)a=t.substr(r,2),r+=2;else{if("u"!==e){i+="\\"+e;continue}a=t.substr(r,4),r+=4}if(!a.match(/^[0123456789abcdefABCDEF]+$/))return t;if(s=parseInt(a,16),s>=0&&32>s){i+="x"===e?"\\x"+a:"\\u"+a;continue}if(34===s||39===s||92===s)i+="\\"+String.fromCharCode(s);else{if("x"===e&&s>126&&255>=s)return t;i+=String.fromCharCode(s)}}else"\\"===e?n=!0:i+=e;return i}function y(t){for(var e=ee,n=G.charAt(e);x(n,J)&&n!==t;){if(e++,e>=le)return!1;n=G.charAt(e)}return n===t}function b(){var t;if(he=0,ee>=le)return["","TK_EOF"];se=!1,ce=[];var e=G.charAt(ee);for(ee+=1;x(e,J);){if("\n"===e?(he+=1,ce=[]):he&&(e===Y?ce.push(Y):"\r"!==e&&ce.push(" ")),ee>=le)return["","TK_EOF"];e=G.charAt(ee),ee+=1}if(x(e,V)){if(le>ee)for(;x(G.charAt(ee),V)&&(e+=G.charAt(ee),ee+=1,ee!==le););if(ee!==le&&e.match(/^[0-9]+[Ee]$/)&&("-"===G.charAt(ee)||"+"===G.charAt(ee))){var n=G.charAt(ee);ee+=1;var i=b();return e+=n+i[0],[e,"TK_WORD"]}return"in"===e?[e,"TK_OPERATOR"]:[e,"TK_WORD"]}if("("===e||"["===e)return[e,"TK_START_EXPR"];if(")"===e||"]"===e)return[e,"TK_END_EXPR"];if("{"===e)return[e,"TK_START_BLOCK"];if("}"===e)return[e,"TK_END_BLOCK"];if(";"===e)return[e,"TK_SEMICOLON"];if("/"===e){var a="",s=!0;if("*"===G.charAt(ee)){if(ee+=1,le>ee)for(;le>ee&&("*"!==G.charAt(ee)||!G.charAt(ee+1)||"/"!==G.charAt(ee+1))&&(e=G.charAt(ee),a+=e,("\n"===e||"\r"===e)&&(s=!1),ee+=1,!(ee>=le)););return ee+=2,s&&0===he?["/*"+a+"*/","TK_INLINE_COMMENT"]:["/*"+a+"*/","TK_BLOCK_COMMENT"]}if("/"===G.charAt(ee)){for(a=e;"\r"!==G.charAt(ee)&&"\n"!==G.charAt(ee)&&(a+=G.charAt(ee),ee+=1,!(ee>=le)););return[a,"TK_COMMENT"]}}if("'"===e||'"'===e||("/"===e||de.e4x&&"<"===e&&G.slice(ee-1).match(/^<[a-zA-Z:0-9]+\s*([a-zA-Z:0-9]+="[^"]*"\s*)*\/?\s*>/))&&("TK_WORD"===Q&&A(Z.last_text)||"TK_END_EXPR"===Q&&x(q.mode,[fe.Conditional,fe.ForInitializer])||x(Q,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var _=e,o=!1,l=!1;if(t=e,le>ee)if("/"===_){for(var h=!1;o||h||G.charAt(ee)!==_;)if(t+=G.charAt(ee),o?o=!1:(o="\\"===G.charAt(ee),"["===G.charAt(ee)?h=!0:"]"===G.charAt(ee)&&(h=!1)),ee+=1,ee>=le)return[t,"TK_STRING"]}else if(de.e4x&&"<"===_){var c=/<(\/?)([a-zA-Z:0-9]+)\s*([a-zA-Z:0-9]+="[^"]*"\s*)*(\/?)\s*>/g,u=G.slice(ee-1),f=c.exec(u);if(f&&0===f.index){for(var d=f[2],p=0;f;){var T=!!f[1],g=f[2],K=!!f[f.length-1];if(g!==d||K||(T?--p:++p),0>=p)break;f=c.exec(u)}var v=f?f.index+f[0].length:u.length;return ee+=v-1,[u.slice(0,v),"TK_STRING"]}}else for(;o||G.charAt(ee)!==_;)if(t+=G.charAt(ee),o?(("x"===G.charAt(ee)||"u"===G.charAt(ee))&&(l=!0),o=!1):o="\\"===G.charAt(ee),ee+=1,ee>=le)return[t,"TK_STRING"];if(ee+=1,t+=_,l&&de.unescape_strings&&(t=O(t)),"/"===_)for(;le>ee&&x(G.charAt(ee),V);)t+=G.charAt(ee),ee+=1;return[t,"TK_STRING"]}if("#"===e){if(0===z.length&&"!"===G.charAt(ee)){for(t=e;le>ee&&"\n"!==e;)e=G.charAt(ee),t+=e,ee+=1;return[r(t)+"\n","TK_UNKNOWN"]}var E="#";if(le>ee&&x(G.charAt(ee),ie)){do e=G.charAt(ee),E+=e,ee+=1;while(le>ee&&"#"!==e&&"="!==e);return"#"===e||("["===G.charAt(ee)&&"]"===G.charAt(ee+1)?(E+="[]",ee+=2):"{"===G.charAt(ee)&&"}"===G.charAt(ee+1)&&(E+="{}",ee+=2)),[E,"TK_WORD"]}}if("<"===e&&"<!--"===G.substring(ee-1,ee+3)){for(ee+=3,e="<!--";"\n"!==G.charAt(ee)&&le>ee;)e+=G.charAt(ee),ee++;return Z.in_html_comment=!0,[e,"TK_COMMENT"]}if("-"===e&&Z.in_html_comment&&"-->"===G.substring(ee-1,ee+2))return Z.in_html_comment=!1,ee+=2,["-->","TK_COMMENT"];if("."===e)return[e,"TK_DOT"];if(x(e,te)){for(;le>ee&&x(e+G.charAt(ee),te)&&(e+=G.charAt(ee),ee+=1,!(ee>=le)););return","===e?[e,"TK_COMMA"]:"="===e?[e,"TK_EQUALS"]:[e,"TK_OPERATOR"]}return[e,"TK_UNKNOWN"]}function N(){if(E(),"["===X){if("TK_WORD"===Q||")"===Z.last_text)return x(Z.last_text,ne)&&(oe=!0),T(fe.Expression),d(),void(de.space_in_paren&&(oe=!0));g(Z.mode)&&("["===Z.last_text||","===Z.last_text&&("]"===$||"}"===$))&&(de.keep_array_indentation||h())}else T("for"===Z.last_text?fe.ForInitializer:x(Z.last_text,["if","while"])?fe.Conditional:fe.Expression);";"===Z.last_text||"TK_START_BLOCK"===Q?h():"TK_END_EXPR"===Q||"TK_START_EXPR"===Q||"TK_END_BLOCK"===Q||"."===Z.last_text?se&&h():"TK_WORD"!==Q&&"TK_OPERATOR"!==Q?oe=!0:"function"===Z.last_word||"typeof"===Z.last_word?de.jslint_happy&&(oe=!0):(x(Z.last_text,ne)||"catch"===Z.last_text)&&de.space_before_conditional&&(oe=!0),"("===X&&("TK_EQUALS"===Q||"TK_OPERATOR"===Q)&&Z.mode!==fe.ObjectLiteral&&l(),d(),de.space_in_paren&&(oe=!0),"["===X&&(T(fe.ArrayLiteral),p()),ae&&(ae=!1,p())}function R(){for(;Z.mode===fe.Statement;)v();"]"===X&&g(Z.mode)&&Z.multiline_array&&!de.keep_array_indentation&&h(),v(),de.space_in_paren&&(oe=!0),d(),Z.do_while&&q.mode===fe.Conditional&&(q.mode=fe.Expression,Z.do_block=!1,Z.do_while=!1)}function k(){T(fe.BlockStatement);var t=y("}"),e=t&&"function"===Z.last_word&&"TK_END_EXPR"===Q;"expand"===de.brace_style?"TK_OPERATOR"!==Q&&(e||"TK_EQUALS"===Q||A(Z.last_text)&&"else"!==Z.last_text)?oe=!0:h():"TK_OPERATOR"!==Q&&"TK_START_EXPR"!==Q?"TK_START_BLOCK"===Q?h():oe=!0:g(q.mode)&&","===Z.last_text&&("}"===$?oe=!0:h()),d(),p()}function S(){for(;Z.mode===fe.Statement;)v();v();var t="TK_START_BLOCK"===Q;"expand"===de.brace_style?t||h():t||(g(Z.mode)&&de.keep_array_indentation?(de.keep_array_indentation=!1,h(),de.keep_array_indentation=!0):h()),d()}function w(){if(E()||!se||K(Z.mode)||"TK_OPERATOR"===Q&&"--"!==Z.last_text&&"++"!==Z.last_text||"TK_EQUALS"===Q||!de.preserve_newlines&&"var"===Z.last_text||h(),Z.do_block&&!Z.do_while){if("while"===X)return oe=!0,d(),oe=!0,void(Z.do_while=!0);h(),Z.do_block=!1}if(ae&&A(X)&&(ae=!1),Z.if_block&&"else"!==X){for(;Z.mode===fe.Statement;)v();Z.if_block=!1}return"function"===X?(Z.var_line&&"TK_EQUALS"!==Q&&(Z.var_line_reindented=!0),!s()&&";"!==Z.last_text&&"}"!==Z.last_text||"{"===Z.last_text||g(Z.mode)||(s()||h(!0),_()||h(!0)),"TK_WORD"===Q?"get"===Z.last_text||"set"===Z.last_text||"new"===Z.last_text||"return"===Z.last_text?oe=!0:h():"TK_OPERATOR"===Q||"="===Z.last_text?oe=!0:K(Z.mode)||h(),d(),void(Z.last_word=X)):"case"===X||"default"===X&&Z.in_case_statement?(h(),(Z.case_body||de.jslint_happy)&&(Z.indentation_level--,Z.case_body=!1),d(),Z.in_case=!0,void(Z.in_case_statement=!0)):(re="NONE","TK_END_BLOCK"===Q?x(X,["else","catch","finally"])?"expand"===de.brace_style||"end-expand"===de.brace_style?re="NEWLINE":(re="SPACE",oe=!0):re="NEWLINE":"TK_SEMICOLON"===Q&&Z.mode===fe.BlockStatement?re="NEWLINE":"TK_SEMICOLON"===Q&&K(Z.mode)?re="SPACE":"TK_STRING"===Q?re="NEWLINE":"TK_WORD"===Q?re="SPACE":"TK_START_BLOCK"===Q?re="NEWLINE":"TK_END_EXPR"===Q&&(oe=!0,re="NEWLINE"),x(X,ne)&&")"!==Z.last_text&&(re="else"===Z.last_text?"SPACE":"NEWLINE"),("TK_COMMA"===Q||"TK_START_EXPR"===Q||"TK_EQUALS"===Q||"TK_OPERATOR"===Q)&&Z.mode!==fe.ObjectLiteral&&l(),x(X,["else","catch","finally"])?"TK_END_BLOCK"!==Q||"expand"===de.brace_style||"end-expand"===de.brace_style?h():(i(!0),"}"!==z[z.length-1]&&h(),oe=!0):"NEWLINE"===re?A(Z.last_text)?oe=!0:"TK_END_EXPR"!==Q?"TK_START_EXPR"===Q&&"var"===X||":"===Z.last_text||("if"===X&&"else"===Z.last_word&&"{"!==Z.last_text?oe=!0:(Z.var_line=!1,Z.var_line_reindented=!1,h())):x(X,ne)&&")"!==Z.last_text&&(Z.var_line=!1,Z.var_line_reindented=!1,h()):g(Z.mode)&&","===Z.last_text&&"}"===$?h():"SPACE"===re&&(oe=!0),d(),Z.last_word=X,"var"===X&&(Z.var_line=!0,Z.var_line_reindented=!1,Z.var_line_tainted=!1),"do"===X&&(Z.do_block=!0),void("if"===X&&(Z.if_block=!0)))}function C(){for(;Z.mode===fe.Statement&&!Z.if_block;)v();d(),Z.var_line=!1,Z.var_line_reindented=!1,Z.mode===fe.ObjectLiteral&&(Z.mode=fe.BlockStatement)}function L(){E()?oe=!0:"TK_WORD"===Q?oe=!0:"TK_COMMA"===Q||"TK_START_EXPR"===Q||"TK_EQUALS"===Q||"TK_OPERATOR"===Q?Z.mode!==fe.ObjectLiteral&&l():h(),d()}function I(){Z.var_line&&(Z.var_line_tainted=!0),oe=!0,d(),oe=!0}function P(){return Z.var_line?((K(Z.mode)||"TK_END_BLOCK"===Q)&&(Z.var_line_tainted=!1),Z.var_line&&(Z.var_line_reindented=!0),d(),void(Z.var_line_tainted?(Z.var_line_tainted=!1,h()):oe=!0)):void("TK_END_BLOCK"===Q&&Z.mode!==fe.Expression?(d(),Z.mode===fe.ObjectLiteral&&"}"===Z.last_text?h():oe=!0):Z.mode===fe.ObjectLiteral?(d(),h()):(d(),oe=!0))}function j(){var t=!0,e=!0;return A(Z.last_text)?(oe=!0,void d()):"*"!==X||"TK_DOT"!==Q||$.match(/^\d+$/)?":"===X&&Z.in_case?(Z.case_body=!0,p(),d(),h(),void(Z.in_case=!1)):"::"===X?void d():(!se||"--"!==X&&"++"!==X||h(),x(X,["--","++","!"])||x(X,["-","+"])&&(x(Q,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||x(Z.last_text,ne)||","===Z.last_text)?(t=!1,e=!1,";"===Z.last_text&&K(Z.mode)&&(t=!0),"TK_WORD"===Q&&x(Z.last_text,ne)&&(t=!0),Z.mode!==fe.BlockStatement&&Z.mode!==fe.Statement||"{"!==Z.last_text&&";"!==Z.last_text||h()):":"===X?0===Z.ternary_depth?(Z.mode===fe.BlockStatement&&(Z.mode=fe.ObjectLiteral),t=!1):Z.ternary_depth-=1:"?"===X&&(Z.ternary_depth+=1),oe=oe||t,d(),void(oe=e)):void d()}function M(){var t,e=a(X);if(m(e.slice(1),"*"))for(h(!1,!0),d(e[0]),t=1;t<e.length;t++)h(!1,!0),d(" "+r(e[t]));else for(e.length>1?h(!1,!0):"TK_END_BLOCK"===Q?h(!1,!0):oe=!0,d(e[0]),z.push("\n"),t=1;t<e.length;t++)z.push(e[t]),z.push("\n");y("\n")||h(!1,!0)}function D(){oe=!0,d(),oe=!0}function U(){se?h(!1,!0):i(!0),oe=!0,d(),h(!1,!0)}function B(){A(Z.last_text)?oe=!0:l(")"===Z.last_text&&de.break_chained_methods),s()&&(ae=!0),d()}function W(){d(),"\n"===X[X.length-1]&&h()}var G,z,X,F,Q,$,Y,Z,q,H,J,V,te,ee,ne,ie,re,ae,se,_e,oe,le,he,ce,ue,fe,de,pe="";for(J="\n\r	 ".split(""),V="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split(""),ie="0123456789".split(""),te="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::",te+=" <%= <% %> <?= <? ?>",te=te.split(" "),ne="continue,try,throw,return,var,if,switch,case,default,for,while,break,function".split(","),fe={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"},ue={TK_START_EXPR:N,TK_END_EXPR:R,TK_START_BLOCK:k,TK_END_BLOCK:S,TK_WORD:w,TK_SEMICOLON:C,TK_STRING:L,TK_EQUALS:I,TK_OPERATOR:j,TK_COMMA:P,TK_BLOCK_COMMENT:M,TK_INLINE_COMMENT:D,TK_COMMENT:U,TK_DOT:B,TK_UNKNOWN:W},e=e?e:{},de={},void 0!==e.space_after_anon_function&&void 0===e.jslint_happy&&(e.jslint_happy=e.space_after_anon_function),void 0!==e.braces_on_own_line&&(de.brace_style=e.braces_on_own_line?"expand":"collapse"),de.brace_style=e.brace_style?e.brace_style:de.brace_style?de.brace_style:"collapse","expand-strict"===de.brace_style&&(de.brace_style="expand"),de.indent_size=e.indent_size?parseInt(e.indent_size,10):4,de.indent_char=e.indent_char?e.indent_char:" ",de.preserve_newlines=void 0===e.preserve_newlines?!0:e.preserve_newlines,de.break_chained_methods=void 0===e.break_chained_methods?!1:e.break_chained_methods,de.max_preserve_newlines=void 0===e.max_preserve_newlines?0:parseInt(e.max_preserve_newlines,10),de.space_in_paren=void 0===e.space_in_paren?!1:e.space_in_paren,de.jslint_happy=void 0===e.jslint_happy?!1:e.jslint_happy,de.keep_array_indentation=void 0===e.keep_array_indentation?!1:e.keep_array_indentation,de.space_before_conditional=void 0===e.space_before_conditional?!0:e.space_before_conditional,de.unescape_strings=void 0===e.unescape_strings?!1:e.unescape_strings,de.wrap_line_length=void 0===e.wrap_line_length?0:parseInt(e.wrap_line_length,10),de.e4x=void 0===e.e4x?!1:e.e4x,Y="";de.indent_size>0;)Y+=de.indent_char,de.indent_size-=1;for(;t&&(" "===t.charAt(0)||"	"===t.charAt(0));)pe+=t.charAt(0),t=t.substring(1);G=t,le=t.length,Q="TK_START_BLOCK",$="",z=[],_e=!1,oe=!1,ce=[],H=[],T(fe.BlockStatement),ee=0,this.beautify=function(){for(var t,e,n,i;;){if(t=b(),X=t[0],F=t[1],"TK_EOF"===F)break;if(n=de.keep_array_indentation&&g(Z.mode))for(e=0;he>e;e+=1)h(!0);else if(se=he>0,de.max_preserve_newlines&&he>de.max_preserve_newlines&&(he=de.max_preserve_newlines),de.preserve_newlines&&he>1)for(h(),e=1;he>e;e+=1)h(!0);ue[F](),"TK_INLINE_COMMENT"!==F&&"TK_COMMENT"!==F&&"TK_UNKNOWN"!==F&&($=Z.last_text,Q=F,Z.last_text=X)}return i=pe+z.join("").replace(/[\r\n ]+$/,"")}}"function"==typeof define?define(function(e,n){n.js_beautify=t}):"undefined"!=typeof exports?exports.js_beautify=t:"undefined"!=typeof window?window.js_beautify=t:"undefined"!=typeof global&&(global.js_beautify=t)}(),function(){function t(t,e,n,i){function r(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.Utils={whitespace:"\n\r	 ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(t,e){for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1}},this.get_content=function(){for(var t="",e=[],n=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return e.length?e.join(""):["","TK_EOF"];if(t=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(t,this.Utils.whitespace))e.length&&(n=!0),this.line_char_count--;else{if(n){if(this.line_char_count>=this.max_char){e.push("\n");for(var i=0;i<this.indent_level;i++)e.push(this.indent_string);this.line_char_count=0}else e.push(" "),this.line_char_count++;n=!1}e.push(t)}}return e.length?e.join(""):""},this.get_contents_to=function(t){if(this.pos===this.input.length)return["","TK_EOF"];var e="",n=new RegExp("</"+t+"\\s*>","igm");n.lastIndex=this.pos;var i=n.exec(this.input),r=i?i.index:this.input.length;return this.pos<r&&(e=this.input.substring(this.pos,r),this.pos=r),e},this.record_tag=function(t){this.tags[t+"count"]?(this.tags[t+"count"]++,this.tags[t+this.tags[t+"count"]]=this.indent_level):(this.tags[t+"count"]=1,this.tags[t+this.tags[t+"count"]]=this.indent_level),this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent,this.tags.parent=t+this.tags[t+"count"]},this.retrieve_tag=function(t){if(this.tags[t+"count"]){for(var e=this.tags.parent;e&&t+this.tags[t+"count"]!==e;)e=this.tags[e+"parent"];e&&(this.indent_level=this.tags[t+this.tags[t+"count"]],this.tags.parent=this.tags[e+"parent"]),delete this.tags[t+this.tags[t+"count"]+"parent"],delete this.tags[t+this.tags[t+"count"]],1===this.tags[t+"count"]?delete this.tags[t+"count"]:this.tags[t+"count"]--}},this.get_tag=function(t){var e,n,i="",r=[],a="",s=!1,_=this.pos,o=this.line_char_count;t=void 0!==t?t:!1;do{if(this.pos>=this.input.length)return t&&(this.pos=_,this.line_char_count=o),r.length?r.join(""):["","TK_EOF"];i=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(i,this.Utils.whitespace)?(s=!0,this.line_char_count--):(("'"===i||'"'===i)&&(r[1]&&"!"===r[1]||(i+=this.get_unformatted(i),s=!0)),"="===i&&(s=!1),r.length&&"="!==r[r.length-1]&&">"!==i&&s&&(this.line_char_count>=this.max_char?(this.print_newline(!1,r),this.line_char_count=0):(r.push(" "),this.line_char_count++),s=!1),"<"===i&&(e=this.pos-1),r.push(i))}while(">"!==i);var l,c=r.join("");l=c.indexOf(-1!==c.indexOf(" ")?" ":">");var u=c.substring(1,l).toLowerCase();return"/"===c.charAt(c.length-2)||this.Utils.in_array(u,this.Utils.single_token)?t||(this.tag_type="SINGLE"):"script"===u?t||(this.record_tag(u),this.tag_type="SCRIPT"):"style"===u?t||(this.record_tag(u),this.tag_type="STYLE"):this.is_unformatted(u,h)?(a=this.get_unformatted("</"+u+">",c),r.push(a),e>0&&this.Utils.in_array(this.input.charAt(e-1),this.Utils.whitespace)&&r.splice(0,0,this.input.charAt(e-1)),n=this.pos-1,this.Utils.in_array(this.input.charAt(n+1),this.Utils.whitespace)&&r.push(this.input.charAt(n+1)),this.tag_type="SINGLE"):"!"===u.charAt(0)?-1!==u.indexOf("[if")?(-1!==c.indexOf("!IE")&&(a=this.get_unformatted("-->",c),r.push(a)),t||(this.tag_type="START")):-1!==u.indexOf("[endif")?(this.tag_type="END",this.unindent()):-1!==u.indexOf("[cdata[")?(a=this.get_unformatted("]]>",c),r.push(a),t||(this.tag_type="SINGLE")):(a=this.get_unformatted("-->",c),r.push(a),this.tag_type="SINGLE"):t||("/"===u.charAt(0)?(this.retrieve_tag(u.substring(1)),this.tag_type="END"):(this.record_tag(u),this.tag_type="START"),this.Utils.in_array(u,this.Utils.extra_liners)&&this.print_newline(!0,this.output)),t&&(this.pos=_,this.line_char_count=o),r.join("")},this.get_unformatted=function(t,e){if(e&&-1!==e.toLowerCase().indexOf(t))return"";var n="",i="",r=!0;do{if(this.pos>=this.input.length)return i;if(n=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(n,this.Utils.whitespace)){if(!r){this.line_char_count--;continue}if("\n"===n||"\r"===n){i+="\n",this.line_char_count=0;continue}}i+=n,this.line_char_count++,r=!0}while(-1===i.toLowerCase().indexOf(t));return i},this.get_token=function(){var t;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var e=this.last_token.substr(7);return t=this.get_contents_to(e),"string"!=typeof t?t:[t,"TK_"+e]}if("CONTENT"===this.current_mode)return t=this.get_content(),"string"!=typeof t?t:[t,"TK_CONTENT"];if("TAG"===this.current_mode){if(t=this.get_tag(),"string"!=typeof t)return t;var n="TK_TAG_"+this.tag_type;return[t,n]}},this.get_full_indent=function(t){return t=this.indent_level+t||0,1>t?"":Array(t+1).join(this.indent_string)},this.is_unformatted=function(t,e){if(!this.Utils.in_array(t,e))return!1;if("a"!==t.toLowerCase()||!this.Utils.in_array("a",e))return!0;var n=this.get_tag(!0),i=(n||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!i||this.Utils.in_array(i,e)?!0:!1},this.printer=function(t,e,n,i,r){this.input=t||"",this.output=[],this.indent_character=e,this.indent_string="",this.indent_size=n,this.brace_style=r,this.indent_level=0,this.max_char=i,this.line_char_count=0;for(var a=0;a<this.indent_size;a++)this.indent_string+=this.indent_character;this.print_newline=function(t,e){if(this.line_char_count=0,e&&e.length){if(!t)for(;this.Utils.in_array(e[e.length-1],this.Utils.whitespace);)e.pop();e.push("\n");for(var n=0;n<this.indent_level;n++)e.push(this.indent_string)}},this.print_token=function(t){this.output.push(t)},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var a,s,_,o,l,h;for(e=e||{},s=e.indent_size||4,_=e.indent_char||" ",l=e.brace_style||"collapse",o=0===e.max_char?1/0:e.max_char||250,h=e.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],a=new r,a.printer(t,_,s,o,l);;){var c=a.get_token();if(a.token_text=c[0],a.token_type=c[1],"TK_EOF"===a.token_type)break;switch(a.token_type){case"TK_TAG_START":a.print_newline(!1,a.output),a.print_token(a.token_text),a.indent(),a.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":a.print_newline(!1,a.output),a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===a.last_token&&""===a.last_text){var u=a.token_text.match(/\w+/)[0],f=a.output[a.output.length-1].match(/<\s*(\w+)/);(null===f||f[1]!==u)&&a.print_newline(!0,a.output)}a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var d=a.token_text.match(/^\s*<([a-z]+)/i);d&&a.Utils.in_array(d[1],h)||a.print_newline(!1,a.output),a.print_token(a.token_text),a.current_mode="CONTENT";break;case"TK_CONTENT":""!==a.token_text&&a.print_token(a.token_text),a.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==a.token_text){a.output.push("\n");var p,T=a.token_text,g=1;"TK_SCRIPT"===a.token_type?p="function"==typeof n&&n:"TK_STYLE"===a.token_type&&(p="function"==typeof i&&i),"keep"===e.indent_scripts?g=0:"separate"===e.indent_scripts&&(g=-a.indent_level);var K=a.get_full_indent(g);if(p)T=p(T.replace(/^\s*/,K),e);else{var v=T.match(/^\s*/)[0],E=v.match(/[^\n\r]*$/)[0].split(a.indent_string).length-1,m=a.get_full_indent(g-E);T=T.replace(/^\s*/,K).replace(/\r\n|\r|\n/g,"\n"+m).replace(/\s*$/,"")}T&&(a.print_token(T),a.print_newline(!0,a.output))}a.current_mode="TAG"}a.last_token=a.token_type,a.last_text=a.token_text}return a.output.join("")}if("function"==typeof define)define(function(e,n){var i=e("./beautify.js").js_beautify,r=e("./beautify-css.js").css_beautify;n.html_beautify=function(e,n){return t(e,n,i,r)}});else if("undefined"!=typeof exports){var e=require("./beautify.js").js_beautify,n=require("./beautify-css.js").css_beautify;exports.html_beautify=function(i,r){return t(i,r,e,n)}}else"undefined"!=typeof window?window.html_beautify=function(e,n){return t(e,n,window.js_beautify,window.css_beautify)}:"undefined"!=typeof global&&(global.html_beautify=function(e,n){return t(e,n,global.js_beautify,global.css_beautify)})}();