!function(){function e(e){return CKEDITOR.env.ie?e.$.clientWidth:parseInt(e.getComputedStyle("width"),10)}function t(e,t){var n=e.getComputedStyle("border-"+t+"-width"),o={thin:"0px",medium:"1px",thick:"2px"};return 0>n.indexOf("px")&&(n=n in o&&"none"!=e.getComputedStyle("border-style")?o[n]:0),parseInt(n,10)}function n(e){var n,o=[],a=-1,i="rtl"==e.getComputedStyle("direction");n=e.$.rows;for(var r,l,s,u=0,d=0,m=n.length;m>d;d++)s=n[d],r=s.cells.length,r>u&&(u=r,l=s);for(n=l,u=new CKEDITOR.dom.element(e.$.tBodies[0]),r=u.getDocumentPosition(),l=0,s=n.cells.length;s>l;l++){var c,f,d=new CKEDITOR.dom.element(n.cells[l]),m=n.cells[l+1]&&new CKEDITOR.dom.element(n.cells[l+1]),a=a+(d.$.colSpan||1),h=d.getDocumentPosition().x;i?f=h+t(d,"left"):c=h+d.$.offsetWidth-t(d,"right"),m?(h=m.getDocumentPosition().x,i?c=h+m.$.offsetWidth-t(m,"right"):f=h+t(m,"left")):(h=e.getDocumentPosition().x,i?c=h:f=h+e.$.offsetWidth),d=Math.max(f-c,3),o.push({table:e,index:a,x:c,y:r.y,width:d,height:u.$.offsetHeight,rtl:i})}return o}function o(e){(e.data||e).preventDefault()}function a(n){function a(){h=0,f.setOpacity(0),p&&i();var e=m.table;setTimeout(function(){e.removeCustomData("_cke_table_pillars")},0),c.removeListener("dragstart",o)}function i(){for(var n=m.rtl,o=n?b.length:v.length,a=0;o>a;a++){var i=v[a],l=b[a],s=m.table;CKEDITOR.tools.setTimeout(function(e,t,o,a,i,l){e&&e.setStyle("width",r(Math.max(t+l,0))),o&&o.setStyle("width",r(Math.max(a-l,0))),i&&s.setStyle("width",r(i+l*(n?-1:1)))},0,this,[i,i&&e(i),l,l&&e(l),(!i||!l)&&e(s)+t(s,"left")+t(s,"right"),p])}}function s(t){o(t);for(var t=m.index,n=CKEDITOR.tools.buildTableMap(m.table),a=[],i=[],r=Number.MAX_VALUE,l=r,s=m.rtl,D=0,C=n.length;C>D;D++){var T=n[D],w=T[t+(s?1:0)],T=T[t+(s?0:1)],w=w&&new CKEDITOR.dom.element(w),T=T&&new CKEDITOR.dom.element(T);w&&T&&w.equals(T)||(w&&(r=Math.min(r,e(w))),T&&(l=Math.min(l,e(T))),a.push(w),i.push(T))}v=a,b=i,y=m.x-r,x=m.x+l,f.setOpacity(.5),g=parseInt(f.getStyle("left"),10),p=0,h=1,f.on("mousemove",d),c.on("dragstart",o),c.on("mouseup",u,this)}function u(e){e.removeListener(),a()}function d(e){D(e.data.getPageOffset().x)}var m,c,f,h,g,p,v,b,y,x;c=n.document,f=CKEDITOR.dom.element.createFromHtml('<div data-cke-temp=1 contenteditable=false unselectable=on style="position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;padding:0;background-color:#004;background-image:none;border:0px none;z-index:10"></div>',c),l||c.getDocumentElement().append(f),this.attachTo=function(e){h||(l&&(c.getBody().append(f),p=0),m=e,f.setStyles({width:r(e.width),height:r(e.height),left:r(e.x),top:r(e.y)}),l&&f.setOpacity(.25),f.on("mousedown",s,this),c.getBody().setStyle("cursor","col-resize"),f.show())};var D=this.move=function(e){if(!m)return 0;if(!h&&(e<m.x||e>m.x+m.width))return m=null,h=p=0,c.removeListener("mouseup",u),f.removeListener("mousedown",s),f.removeListener("mousemove",d),c.getBody().setStyle("cursor","auto"),l?f.remove():f.hide(),0;if(e-=Math.round(f.$.offsetWidth/2),h){if(e==y||e==x)return 1;e=Math.max(e,y),e=Math.min(e,x),p=e-g}return f.setStyle("left",r(e)),1}}function i(e){var t=e.data.getTarget();if("mouseout"==e.name){if(!t.is("table"))return;for(var n=new CKEDITOR.dom.element(e.data.$.relatedTarget||e.data.$.toElement);n&&n.$&&!n.equals(t)&&!n.is("body");)n=n.getParent();if(!n||n.equals(t))return}t.getAscendant("table",1).removeCustomData("_cke_table_pillars"),e.removeListener()}var r=CKEDITOR.tools.cssLength,l=CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks);CKEDITOR.plugins.add("tableresize",{requires:"tabletools",init:function(e){e.on("contentDom",function(){var t;e.document.getBody().on("mousemove",function(r){var r=r.data,l=r.getPageOffset().x;if(t&&t.move(l))o(r);else{var s,r=r.getTarget();if(r.is("table")||r.getAscendant("tbody",1)){s=r.getAscendant("table",1),(r=s.getCustomData("_cke_table_pillars"))||(s.setCustomData("_cke_table_pillars",r=n(s)),s.on("mouseout",i),s.on("mousedown",i));e:{s=0;for(var u=r.length;u>s;s++){var d=r[s];if(l>=d.x&&l<=d.x+d.width){l=d;break e}}l=null}l&&(!t&&(t=new a(e)),t.attachTo(l))}}})})}})}();