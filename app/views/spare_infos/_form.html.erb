<%= twbs_form_for @resource, :url => polymorphic_path([:admin, @resource], return_path: params[:return_path]) do |f| %>

  <%= f.alert_danger do %>
    <%= f.object.errors[:base].join('<br>'.html_safe) %>
  <% end %>

  <%= d1 do %>

    <%= f.twbs_text_field :catalog_number %>

    <%= f.fields_for :brand, f.object.brand || f.object.build_brand, include_id: false do |b| %>
      <%= f.form_group :brand do %>
        <%= b.twbs_select2 :name, rel: 'select2-brand', data: {"true-id" => f.object.brand_id}, asterisk: true %>
        <%= f.error(:brand) %>
      <% end %>
    <% end %>

    <%= f.twbs_check_box :fix_spare_catalog %>
    <%= f.twbs_hidden_field :change_spare_catalog, value: '1' %>

    <%= f.fields_for :spare_catalog, f.object.spare_catalog || f.object.build_spare_catalog, include_id: false do |b| %>
      <%= f.form_group :spare_catalog do %>
        <%= b.twbs_select2 :name, rel: 'select2-spare_catalog', data: {"true-id" => f.object.spare_catalog_id}, asterisk: true %>
        <%= f.error(:spare_catalog) %>
      <% end %>
    <% end %>

    <%= f.fields_for :spare_info_phrases do |spare_info_phrase| %>
      <%= render 'spare_infos/spare_info_phrase_fields', f: spare_info_phrase %>
    <% end %>

    <%= f.form_group do %>
      <%= link_to_add_association 'Добавить фразу', f, :spare_info_phrases, class: "btn btn-success btn-small", :data => {"association-insertion-node" => ".form-group", "association-insertion-traversal" => "closest"}  %>
    <% end %>

    <% (1..8).each do |n| %>
      <%= render 'image_form', f:f, name: "image#{n}" %>
    <% end %>

    <% (1..8).each do |n| %>
      <%= render 'file_form', f:f, name: "file#{n}" %>
    <% end %>

  <% end %>

  <%= row do %>

    <div class="col-md-24" %>

      <%= f.twbs_text_area :content, :class => "ckeditor-extended" %>

      <%= f.twbs_submit %>

    </div>

  <% end %>

<% end %>
